import pandas as pd
import numpy as np
import math

# Wczytanie danych z arkusza Excela
df = pd.read_excel('nazwa_pliku.xlsx')

# Obliczenie poprawki topograficznej dla każdego wiersza
poprawki = []
for i, row in df.iterrows():
    # Współrzędne modelu NMT
    x1, y1, h1 = row['x1'], row['y1'], row['h1']
    
    # Współrzędne rzeczywiste
    x2, y2, h2 = row['x2'], row['y2'], row['h2']
    
    # Obliczenie odległości między punktami
    d = math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2)
    
    # Obliczenie poprawki topograficznej
    r = 6371
    r2 = r + h1
    eq = np.sum(r2 - r + math.sqrt(r**2 + h_diff**2) - math.sqrt(r2 ** 2 + h_diff ** 2))
    TCR = eq * 10 ** 5
    
    # Dodanie wyniku do listy
    poprawki.append(TCR)

# Dodanie kolumny z wynikami do arkusza Excela
df['poprawka_topograficzna'] = poprawki
df['roznica_wysokosci'] = df['h2'] - df['h1']

# Zapisanie wyników do nowego pliku Excela
df.to_excel('nazwa_pliku_wyniki.xlsx', index=False)
